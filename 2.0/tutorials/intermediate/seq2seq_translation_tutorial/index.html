
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pytorch.apachecn.org/2.0/tutorials/intermediate/seq2seq_translation_tutorial/">
      
      
        <link rel="prev" href="../char_rnn_generation_tutorial/">
      
      
        <link rel="next" href="../../beginner/text_sentiment_ngrams_tutorial/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>NLP From Scratch: Translation with a Sequence to Sequence Network and Attention - 【布客】PyTorch 中文翻译</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.d7758b05.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13.274 9.537zl-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074M4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5M4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.5 4.5 0 0 1-.563-1.191 3.84 3.84 0 0 1-.05-2.063 4.65 4.65 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4 2.4 0 0 1-.507-.441 3.1 3.1 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19.01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.7 3.7 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.76 2.76 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6 6 0 0 0-.26.16 1 1 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1 1 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.61.61 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1 1 0 0 0-.34.398M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343za8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746m1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275M6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L6.94 8 4.97 6.03a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005 0-.009.004"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.5 3.5 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327q0 .15-.025.292c.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5q-.002.615-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A5 5 0 0 1 8 16a5 5 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5 5 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.7 1.7 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06m.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.17.17 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5m4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5m0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5M2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nlp" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="【布客】PyTorch 中文翻译" class="md-header__button md-logo" aria-label="【布客】PyTorch 中文翻译" data-md-component="logo">
      
  <img src="https://data.dafeiyang.cn/images/logo/logo_green.webp" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            【布客】PyTorch 中文翻译
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NLP From Scratch: Translation with a Sequence to Sequence Network and Attention
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/apachecn/pytorch-doc-zh" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    apachecn/pytorch-doc-zh
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="【布客】PyTorch 中文翻译" class="md-nav__button md-logo" aria-label="【布客】PyTorch 中文翻译" data-md-component="logo">
      
  <img src="https://data.dafeiyang.cn/images/logo/logo_green.webp" alt="logo">

    </a>
    【布客】PyTorch 中文翻译
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/apachecn/pytorch-doc-zh" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    apachecn/pytorch-doc-zh
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 中文文档 & 教程
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 新特性
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 新特性
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V2.6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V2.6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V2.5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V2.5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V2.4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V2.4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V2.3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V2.3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V2.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V2.2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V2.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V2.1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V2.0
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.13
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.12
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.11
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.10
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.8
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LatestChanges/PyTorch_V1.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V1.2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch 2.x 中文文档 & 教程
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            PyTorch 2.x 中文文档 & 教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    中文教程
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            中文教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyTorch Recipes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            PyTorch Recipes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recipes/recipes_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    See All Recipes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prototype/prototype_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    See All Prototype Recipes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction to PyTorch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction to PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Learn the Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/quickstart_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/tensorqs_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/data_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets & DataLoaders
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/transforms_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transforms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/buildmodel_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build the Neural Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/autogradqs_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic Differentiation with torch.autograd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/optimization_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizing Model Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/basics/saveloadrun_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Save and Load the Model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction to PyTorch on YouTube
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Introduction to PyTorch on YouTube
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/introyt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to PyTorch - YouTube Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/introyt/introyt1_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to PyTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/introyt/tensors_deeper_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to PyTorch Tensors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/introyt/autogradyt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Fundamentals of Autograd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/introyt/modelsyt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Models with PyTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/introyt/tensorboardyt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch TensorBoard Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/introyt/trainingyt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training with PyTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/introyt/captumyt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Understanding with Captum
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Learning PyTorch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            Learning PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/deep_learning_60min_blitz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep Learning with PyTorch: A 60 Minute Blitz
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/pytorch_with_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Learning PyTorch with Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/nn_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is torch.nn really?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorboard_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualizing Models, Data, and Training with TensorBoard
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_5" >
        
          
          <label class="md-nav__link" for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Image and Video
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_5">
            <span class="md-nav__icon md-icon"></span>
            Image and Video
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../torchvision_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchVision Object Detection Finetuning Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/transfer_learning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transfer Learning for Computer Vision Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/fgsm_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adversarial Example Generation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/dcgan_faces_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DCGAN Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spatial_transformer_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spatial Transformer Networks Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/vt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizing Vision Transformer Model for Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tiatoolbox_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Whole Slide Image Classification Using PyTorch and TIAToolbox
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_6" >
        
          
          <label class="md-nav__link" for="__nav_3_1_6" id="__nav_3_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Audio
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_6">
            <span class="md-nav__icon md-icon"></span>
            Audio
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/audio_io_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio I/O
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/audio_resampling_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Resampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/audio_data_augmentation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Data Augmentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/audio_feature_extractions_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Feature Extractions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/audio_feature_augmentation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Feature Augmentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/audio_datasets_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../speech_recognition_pipeline_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Speech Recognition with Wav2Vec2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../text_to_speech_with_torchaudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Text-to-speech with Tacotron2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forced_alignment_with_torchaudio_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forced Alignment with Wav2Vec2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_7" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_7" id="__nav_3_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Text
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_7">
            <span class="md-nav__icon md-icon"></span>
            Text
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/bettertransformer_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fast Transformer Inference with Better Transformer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../char_rnn_classification_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: Classifying Names with a Character-Level RNN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../char_rnn_generation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: Generating Names with a Character-Level RNN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    NLP From Scratch: Translation with a Sequence to Sequence Network and Attention
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    NLP From Scratch: Translation with a Sequence to Sequence Network and Attention
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      正在加载数据文件 ¶
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seq2seq" class="md-nav__link">
    <span class="md-ellipsis">
      Seq2Seq 模型 ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Seq2Seq 模型 ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      编码器 ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      解码器 ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="解码器 ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      简单解码器 ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      注意力解码器 ¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      训练 ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="训练 ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      准备训练数据 ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      训练模型 ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      绘制结果 ¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      评估 ¶
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      训练和评估 ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="训练和评估 ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      可视化注意力 ¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      练习 ¶
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/text_sentiment_ngrams_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Text classification with the torchtext library
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/translation_transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language Translation with nn.Transformer and torchtext
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/torchtext_custom_dataset_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocess custom text dataset using Torchtext
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_8" >
        
          
          <label class="md-nav__link" for="__nav_3_1_8" id="__nav_3_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Backends
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_8">
            <span class="md-nav__icon md-icon"></span>
            Backends
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/onnx/intro_onnx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to ONNX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_9" >
        
          
          <label class="md-nav__link" for="__nav_3_1_9" id="__nav_3_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reinforcement Learning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_9">
            <span class="md-nav__icon md-icon"></span>
            Reinforcement Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reinforcement_q_learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning (DQN) Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reinforcement_ppo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reinforcement Learning (PPO) with TorchRL Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mario_rl_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Train a Mario-playing RL Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/pendulum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pendulum: Writing your environment and transforms with TorchRL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_10" >
        
          
          <label class="md-nav__link" for="__nav_3_1_10" id="__nav_3_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deploying PyTorch Models in Production
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_10">
            <span class="md-nav__icon md-icon"></span>
            Deploying PyTorch Models in Production
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/onnx/intro_onnx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to ONNX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flask_rest_api_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying PyTorch in Python via a REST API with Flask
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/Intro_to_TorchScript_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to TorchScript
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/cpp_export/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loading a TorchScript Model in C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/super_resolution_with_onnxruntime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (optional) Exporting a Model from PyTorch to ONNX and Running it using ONNX Runtime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../realtime_rpi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Real Time Inference on Raspberry Pi 4 (30 fps!)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_11" >
        
          
          <label class="md-nav__link" for="__nav_3_1_11" id="__nav_3_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Profiling PyTorch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_11">
            <span class="md-nav__icon md-icon"></span>
            Profiling PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/profiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling your PyTorch Module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/hta_intro_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to Holistic Trace Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/hta_trace_diff_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trace Diff using Holistic Trace Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_12" >
        
          
          <label class="md-nav__link" for="__nav_3_1_12" id="__nav_3_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Transforms with FX
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_12">
            <span class="md-nav__icon md-icon"></span>
            Code Transforms with FX
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fx_conv_bn_fuser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Building a Convolution/Batch Norm fuser in FX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fx_profiling_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Building a Simple CPU Performance Profiler with FX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_13" >
        
          
          <label class="md-nav__link" for="__nav_3_1_13" id="__nav_3_1_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Frontend APIs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_13">
            <span class="md-nav__icon md-icon"></span>
            Frontend APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory_format_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Channels Last Memory Format in PyTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forward_ad_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forward-mode Automatic Differentiation (Beta)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jacobians_hessians/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jacobians, Hessians, hvp, vhp, and more: composing function transforms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ensembling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model ensembling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../per_sample_grads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Per-sample-gradients
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/cpp_frontend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the PyTorch C++ Frontend
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/torch-script-parallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Parallelism in TorchScript
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/cpp_autograd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autograd in C++ Frontend
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_14" >
        
          
          <label class="md-nav__link" for="__nav_3_1_14" id="__nav_3_1_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Extending PyTorch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_14">
            <span class="md-nav__icon md-icon"></span>
            Extending PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_function_double_backward_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Double Backward with Custom Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_function_conv_bn_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fusing Convolution and Batch Norm using Custom Function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/cpp_extension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom C++ and CUDA Extensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/torch_script_custom_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending TorchScript with Custom C++ Operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/torch_script_custom_classes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending TorchScript with Custom C++ Classes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/dispatcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registering a Dispatched Operator in C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/extend_dispatcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending dispatcher for a new backend in C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/privateuseone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Facilitating New Backend Integration by PrivateUse1
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_15" >
        
          
          <label class="md-nav__link" for="__nav_3_1_15" id="__nav_3_1_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model Optimization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_15">
            <span class="md-nav__icon md-icon"></span>
            Model Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/profiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling your PyTorch Module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorboard_profiler_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Profiler With TensorBoard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/hyperparameter_tuning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperparameter tuning with Ray Tune
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/vt_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizing Vision Transformer Model for Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parametrizations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parametrizations Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pruning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pruning Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/dynamic_quantization_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Dynamic Quantization on an LSTM Word Language Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_quantization_bert_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Dynamic Quantization on BERT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quantized_transfer_learning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Quantized Transfer Learning for Computer Vision Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/static_quantization_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (beta) Static Quantization with Eager Mode in PyTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../torchserve_with_ipex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grokking PyTorch Intel CPU performance from first principles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../torchserve_with_ipex_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grokking PyTorch Intel CPU performance from first principles (Part 2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nvfuser_intro_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started - Accelerate Your Scripts with nvFuser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ax_multiobjective_nas_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Objective NAS with Ax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../torch_compile_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to torch.compile
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inductor_debug_cpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inductor CPU backend debugging and profiling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaled_dot_product_attention_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (Beta) Implementing High-Performance Transformers with Scaled Dot Product Attention (SDPA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaled_dot_product_attention_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (Beta) Implementing High-Performance Transformers with Scaled Dot Product Attention (SDPA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaled_dot_product_attention_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (Beta) Implementing High-Performance Transformers with Scaled Dot Product Attention (SDPA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaled_dot_product_attention_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    (Beta) Implementing High-Performance Transformers with Scaled Dot Product Attention (SDPA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/knowledge_distillation_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Knowledge Distillation Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_16" >
        
          
          <label class="md-nav__link" for="__nav_3_1_16" id="__nav_3_1_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Parallel and Distributed Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_16">
            <span class="md-nav__icon md-icon"></span>
            Parallel and Distributed Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distributed/home/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed and Parallel Training Tutorials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/dist_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Distributed Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/ddp_series_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Data Parallel in PyTorch - Video Tutorials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model_parallel_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single-Machine Model Parallel Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ddp_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with Distributed Data Parallel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dist_tuto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing Distributed Applications with PyTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../FSDP_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with Fully Sharded Data Parallel(FSDP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../FSDP_adavnced_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced Model Training with Fully Sharded Data Parallel (FSDP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TP_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Large Scale Transformer model training with Tensor Parallel (TP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process_group_cpp_extension_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customize Process Group Backends Using Cpp Extensions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rpc_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with Distributed RPC Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rpc_param_server_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementing a Parameter Server Using Distributed RPC Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dist_pipeline_parallel_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Pipeline Parallelism Using RPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rpc_async_execution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementing Batch RPC Processing Using Asynchronous Executions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/rpc_ddp_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Combining Distributed DataParallel with Distributed RPC Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/ddp_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Transformer models using Distributed Data Parallel and Pipeline Parallelism
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/generic_join/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Training with Uneven Inputs Using the Join Context Manager
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_17" >
        
          
          <label class="md-nav__link" for="__nav_3_1_17" id="__nav_3_1_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Edge with ExecuTorch
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_17">
            <span class="md-nav__icon md-icon"></span>
            Edge with ExecuTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/executorch/stable/tutorials/export-to-executorch-tutorial.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exporting to ExecuTorch Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/executorch/stable/running-a-model-cpp-tutorial.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running an ExecuTorch Model in C++ Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/executorch/stable/tutorials/sdk-integration-tutorial.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the ExecuTorch SDK to Profile a Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/executorch/stable/demo-apps-ios.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building an ExecuTorch iOS Demo App
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/executorch/stable/demo-apps-android.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building an ExecuTorch Android Demo App
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/executorch/stable/examples-end-to-end-to-lower-model-to-delegate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lowering a Model as a Delegate
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_18" >
        
          
          <label class="md-nav__link" for="__nav_3_1_18" id="__nav_3_1_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Recommendation Systems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_18">
            <span class="md-nav__icon md-icon"></span>
            Recommendation Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../torchrec_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to TorchRec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/sharding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploring TorchRec sharding
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_19" >
        
          
          <label class="md-nav__link" for="__nav_3_1_19" id="__nav_3_1_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multimodality
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_19">
            <span class="md-nav__icon md-icon"></span>
            Multimodality
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../beginner/flava_finetuning_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchMultimodal Tutorial: Finetuning FLAVA
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    中文文档
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            中文文档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/docs/stable/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pytorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/audio/stable/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Torchaudio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/text/stable/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchText
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/vision/stable/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchVision
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/torcharrow/beta/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchArrow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/torchrec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchRec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/serve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchServe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/torchx/latest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TorchX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch.org/xla/release/2.3/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch on XLA Devices
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch1x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 1.7 中文文档
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch1x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 1.4 中文文档 & 教程
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch1x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 1.0 中文文档 & 教程
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch0x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 0.4 中文文档
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch0x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 0.3 中文文档 & 教程
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://pytorch0x.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch 0.2 中文文档
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contrib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    贡献指南
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apachecn.org/about" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于我们
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apachecn.org/join" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    加入我们
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.apachecn.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    中文资源合集
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      正在加载数据文件 ¶
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seq2seq" class="md-nav__link">
    <span class="md-ellipsis">
      Seq2Seq 模型 ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Seq2Seq 模型 ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      编码器 ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      解码器 ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="解码器 ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      简单解码器 ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      注意力解码器 ¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      训练 ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="训练 ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      准备训练数据 ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      训练模型 ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      绘制结果 ¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      评估 ¶
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      训练和评估 ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="训练和评估 ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      可视化注意力 ¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      练习 ¶
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/apachecn/pytorch-doc-zh/edit/master/docs/2.0/tutorials/intermediate/seq2seq_translation_tutorial.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/apachecn/pytorch-doc-zh/raw/master/docs/2.0/tutorials/intermediate/seq2seq_translation_tutorial.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="nlp">NLP 从头开始​​：使用序列到序列网络和注意力进行翻译 <a href="#nlp-from-scratch-translation-with-a-sequence-to-sequence-network-and-attention" title="此标题的永久链接">¶</a></h1>
<blockquote>
<p>译者：<a href="https://github.com/jiangzhonglian">片刻小哥哥</a></p>
<p>项目地址：<a href="https://pytorch.apachecn.org/2.0/tutorials/intermediate/seq2seq_translation_tutorial">https://pytorch.apachecn.org/2.0/tutorials/intermediate/seq2seq_translation_tutorial</a></p>
<p>原始地址：<a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html">https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html</a></p>
</blockquote>
<p><strong>作者</strong> 
 :
 <a href="https://github.com/spro">肖恩·罗伯逊</a></p>
<p>这是从头开始 “NLP 的第三个也是最后一个教程，我们
编写自己的类和函数来预处理数据以执行我们的 NLP
建模任务。我们希望您完成本教程后’
能够继续学习</p>
<p>torchtext</p>
<p>如何在紧随本教程之后的
三个教程中为您处理大部分预处理工作。</p>
<p>在这个项目中，我们将教一个神经网络将
法语翻译成英语。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>[KEY: &gt; input, = target, &lt; output]
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>&gt; il est en train de peindre un tableau .
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>= he is painting a picture .
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>&lt; he is painting a picture .
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>&gt; pourquoi ne pas essayer ce vin delicieux ?
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>= why not try that delicious wine ?
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>&lt; why not try that delicious wine ?
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>&gt; elle n est pas poete mais romanciere .
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>= she is not a poet but a novelist .
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>&lt; she not not a poet but a novelist .
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>&gt; vous etes trop maigre .
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>= you re too skinny .
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>&lt; you re all alone .
</code></pre></div>
<p>… 取得了不同程度的成功。</p>
<p>这是通过
 <a href="https://arxiv.org/abs/1409.3215">序列到序列网络</a> 的简单但强大的想法成为可能，其中两个
循环神经网络协同工作来进行变换一个序列到另一个序列。编码器网络将输入序列压缩为向量，
解码器网络将该向量展开为新序列。</p>
<p><img alt="" src="https://pytorch.org/tutorials/_images/seq2seq.png" /></p>
<p>为了改进这个模型，我们’将使用
 <a href="https://arxiv.org/abs/1409.0473">注意力机制</a>
，它让解码器
学习关注特定范围的输入序列。</p>
<p><strong>推荐阅读：</strong></p>
<p>我假设您至少已经安装了 PyTorch，了解 Python，并且
了解tensor：</p>
<ul>
<li><a href="https://pytorch.org/">https://pytorch.org/</a>
 安装说明</li>
<li><a href="../beginner/deep_learning_60min_blitz.html">使用 PyTorch 进行深度学习：60 分钟闪电战</a>
 一般开始使用 PyTorch\ n* <a href="../beginner/pytorch_with_examples.html">通过示例学习 PyTorch</a>
 进行广泛而深入的概述</li>
<li><a href="../beginner/former_torchies_tutorial.html">针对前 Torch 用户的 PyTorch</a>
 如果您是前 Lua Torch 用户</li>
</ul>
<p>了解序列到序列网络及其工作原理也很有用：</p>
<ul>
<li><a href="https://arxiv.org/abs/1406.1078">使用 RNN 编码器-解码器进行统计机器翻译学习短语表示</a></li>
<li><a href="https://arxiv.org /abs/1409.3215">使用神经网络进行序列到序列学习</a></li>
<li><a href="https://arxiv.org/abs/1409.0473">通过联合学习对齐和翻译的神经机器翻译</a></li>
<li><a href="https://arxiv.org/abs/1506.05869">神经会话模型</a></li>
</ul>
<p>您还可以找到之前的教程： <a href="char_rnn_classification_tutorial.html">NLP From Scratch：使用字符级 RNN 分类名称</a>和 <a href="char_rnn_Generation_tutorial.html">NLP From Scratch：使用字符级 RNN 生成名称</a>很有帮助，因为这些概念分别与编码器和解码器模型非常相似。</p>
<p><strong>要求</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>from __future__ import unicode_literals, print_function, division
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>from io import open
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>import unicodedata
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>import re
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>import random
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>import torch
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>import torch.nn as nn
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>from torch import optim
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>import torch.nn.functional as F
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>import numpy as np
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>from torch.utils.data import TensorDataset, DataLoader, RandomSampler
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>device = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)
</code></pre></div>
<h2 id="_1">正在加载数据文件 <a href="#loading-data-files" title="固定链接到此标题">¶</a></h2>
<p>-</p>
<p>该项目的数据是一组数千个英语到法语的翻译对。</p>
<p><a href="https://opendata.stackexchange.com/questions/3888/dataset-of-sentences-translated-into-many-languages">关于开放数据堆栈的这个问题
Exchange</a>
 向我指出了开放翻译网站
 <a href="https://tatoeba.org/">https://tatoeba.org/</a>
 可以在
下载
 <a href="https://tatoeba.org/eng/downloads">https://tatoeba.org/eng/downloads</a>
 - 更好
yet，有人做了额外的分割工作将语言对放入
个文本文件中：
 <a href="https://www.manythings.org/anki/">https://www.manythings.org/anki/</a></p>
<p>英语到法语对太大，无法包含在存储库中，因此
请在继续之前下载到
 <code>data/eng-fra.txt</code>
。该文件是一个制表符
分隔的翻译对列表:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>I am cold.    J&#39;ai froid.
</code></pre></div>
<p>没有10</p>
<p>从
 <a href="https://download.pytorch.org/tutorial/data.zip">此处</a> 下载数据并将其解压到当前目录。</p>
<p>与字符级 RNN
 教程中使用的字符编码类似，我们将把语言中的每个单词表示为一个单热
向量，或除单个 1 之外的由 0 组成的巨型向量(在索引处) 
这个词)。与语言中可能存在的数十个字符相比，单词的数量要多得多，因此编码向量要大得多。然而，我们会稍微作弊并修剪数据，以便每种语言只使用
几千个单词。</p>
<p><img alt="" src="https://pytorch.org/tutorials/_images/word-encoding.png" /></p>
<p>我们’将需要每个单词一个唯一的索引，以用作稍后网络的输入和目标。为了跟踪所有这些，我们将使用一个名为 
 <code>Lang</code>
 的帮助器类，它具有单词 → 索引 (
 <code>word2index</code>
 ) 和索引 → word\ n(
 <code>index2word</code>
 ) 个字典，以及每个单词的计数
 <code>word2count</code>
，稍后将用于替换稀有单词。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>SOS_token = 0
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>EOS_token = 1
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>class Lang:
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    def __init__(self, name):
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>        self.name = name
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>        self.word2index = {}
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>        self.word2count = {}
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>        self.index2word = {0: &quot;SOS&quot;, 1: &quot;EOS&quot;}
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>        self.n_words = 2  # Count SOS and EOS
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    def addSentence(self, sentence):
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>        for word in sentence.split(&#39; &#39;):
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>            self.addWord(word)
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    def addWord(self, word):
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>        if word not in self.word2index:
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>            self.word2index[word] = self.n_words
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>            self.word2count[word] = 1
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>            self.index2word[self.n_words] = word
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>            self.n_words += 1
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>        else:
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>            self.word2count[word] += 1
</code></pre></div>
<p>这些文件都是 Unicode 格式的，为了简化，我们将 Unicode
字符转换为 ASCII，将所有内容变为小写，并修剪大部分
标点符号。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a># Turn a Unicode string to plain ASCII, thanks to
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a># https://stackoverflow.com/a/518232/2809427
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>def unicodeToAscii(s):
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    return &#39;&#39;.join(
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>        c for c in unicodedata.normalize(&#39;NFD&#39;, s)
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>        if unicodedata.category(c) != &#39;Mn&#39;
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    )
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a># Lowercase, trim, and remove non-letter characters
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>def normalizeString(s):
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    s = unicodeToAscii(s.lower().strip())
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    s = re.sub(r&quot;([.!?])&quot;, r&quot; \1&quot;, s)
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    s = re.sub(r&quot;[^a-zA-Z!?]+&quot;, r&quot; &quot;, s)
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>    return s.strip()
</code></pre></div>
<p>要读取数据文件，我们将文件分成行，然后将行分成对。这些文件都是英语 → 其他语言，因此，如果我们
想要从其他语言 → 英语翻译，我添加了
 <code>reverse</code>
 标志来反转这些对。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>def readLangs(lang1, lang2, reverse=False):
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    print(&quot;Reading lines...&quot;)
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    # Read the file and split into lines
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    lines = open(&#39;data/%s-%s.txt&#39; % (lang1, lang2), encoding=&#39;utf-8&#39;).\
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>        read().strip().split(&#39;&#39;)
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    # Split every line into pairs and normalize
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    pairs = [[normalizeString(s) for s in l.split(&#39;\t&#39;)] for l in lines]
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    # Reverse pairs, make Lang instances
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    if reverse:
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>        pairs = [list(reversed(p)) for p in pairs]
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>        input_lang = Lang(lang2)
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>        output_lang = Lang(lang1)
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    else:
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>        input_lang = Lang(lang1)
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>        output_lang = Lang(lang2)
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>    return input_lang, output_lang, pairs
</code></pre></div>
<p>由于有
 <em>很多</em> 
 的例句，并且我们希望
快速训练一些东西，\xe2\x80\x99 将把数据集修剪为仅相对较短和
简单的句子。这里最大长度为 10 个单词(包括结尾标点符号)，我们\xe2\x80\x99 重新过滤翻译为</p>
<p>形式\xe2\x80\x9cI am\xe2\x80\x9d 或\xe2\x80\ 的句子x9c他是\xe2\x80\x9d等(考虑到撇号已被替换
)。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>MAX_LENGTH = 10
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>eng_prefixes = (
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    &quot;i am &quot;, &quot;i m &quot;,
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    &quot;he is&quot;, &quot;he s &quot;,
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    &quot;she is&quot;, &quot;she s &quot;,
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    &quot;you are&quot;, &quot;you re &quot;,
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    &quot;we are&quot;, &quot;we re &quot;,
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    &quot;they are&quot;, &quot;they re &quot;
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>)
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>def filterPair(p):
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    return len(p[0].split(&#39; &#39;)) &lt; MAX_LENGTH and \
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>        len(p[1].split(&#39; &#39;)) &lt; MAX_LENGTH and \
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>        p[1].startswith(eng_prefixes)
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>def filterPairs(pairs):
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>    return [pair for pair in pairs if filterPair(pair)]
</code></pre></div>
<p>准备数据的完整过程是：</p>
<ul>
<li>读取文本文件并分成行，将行分成对</li>
<li>规范文本，按长度和内容过滤</li>
<li>从成对的句子中创建单词列表</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>def prepareData(lang1, lang2, reverse=False):
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    input_lang, output_lang, pairs = readLangs(lang1, lang2, reverse)
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    print(&quot;Read %s sentence pairs&quot; % len(pairs))
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    pairs = filterPairs(pairs)
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    print(&quot;Trimmed to %s sentence pairs&quot; % len(pairs))
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    print(&quot;Counting words...&quot;)
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    for pair in pairs:
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>        input_lang.addSentence(pair[0])
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>        output_lang.addSentence(pair[1])
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>    print(&quot;Counted words:&quot;)
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>    print(input_lang.name, input_lang.n_words)
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>    print(output_lang.name, output_lang.n_words)
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>    return input_lang, output_lang, pairs
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>input_lang, output_lang, pairs = prepareData(&#39;eng&#39;, &#39;fra&#39;, True)
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>print(random.choice(pairs))
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Reading lines...
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Read 135842 sentence pairs
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>Trimmed to 11445 sentence pairs
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>Counting words...
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>Counted words:
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>fra 4601
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>eng 2991
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>[&#39;tu preches une convaincue&#39;, &#39;you re preaching to the choir&#39;]
</code></pre></div>
<h2 id="seq2seq">Seq2Seq 模型 <a href="#the-seq2seq-model" title="永久链接到此标题">¶</a></h2>
<p>-</p>
<p>循环神经网络 (RNN) 是一种对序列进行操作并使用其自己的输出作为后续步骤的输入的网络。</p>
<p>A
 <a href="https://arxiv.org/abs/1409.3215">序列到序列网络</a> 
 ，或
seq2seq网络，或
 <a href="https://arxiv.org/pdf/1406.1078v3.pdf">编码器解码器
网络</a> 
 是一个由两个称为编码器和解码器的 RNN 组成的模型。编码器读取
输入序列并输出单个向量，
解码器读取
该向量以生成输出序列。</p>
<p><img alt="" src="https://pytorch.org/tutorials/_images/seq2seq.png" /></p>
<p>与单个 RNN 的序列预测(其中每个输入
对应一个输出)不同，seq2seq 模型使我们摆脱序列
长度和顺序的影响，这使其成为两种
语言之间翻译的理想选择。</p>
<p>考虑这句话
 `Je</p>
<p>ne</p>
<p>suis</p>
<p>pas</p>
<p>le</p>
<p>chat</p>
<p>黑色<code>→</code>我</p>
<p>是</p>
<p>不是</p>
<p>黑猫</p>
<p><code>。输入句子中的大多数单词在输出句子中都有直接
翻译，但
顺序略有不同，例如</code>chat</p>
<p>noir<code>和</code>black</p>
<p>猫<code>.由于</code>ne/pas`
 结构，输入句子中还多了一个单词。直接从输入单词序列
产生正确的翻译是很困难的。</p>
<p>使用 seq2seq 模型，编码器创建单个向量，在理想情况下，将输入序列的 “meaning” 编码为单个
向量 —某个 N 维句子空间中的单个点。</p>
<h3 id="_2">编码器 <a href="#the-encoder" title="此标题的永久链接">¶</a></h3>
<p>seq2seq 网络的编码器是一个 RNN，它为输入句子中的每个单词输出一些值。对于每个输入单词，编码器
输出一个向量和一个隐藏状态，并使用
下一个输入单词的隐藏状态。</p>
<p><img alt="" src="https://pytorch.org/tutorials/_images/encoder-network.png" /></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>class EncoderRNN(nn.Module):
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    def __init__(self, input_size, hidden_size, dropout_p=0.1):
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>        super(EncoderRNN, self).__init__()
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>        self.hidden_size = hidden_size
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>        self.embedding = nn.Embedding(input_size, hidden_size)
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>        self.gru = nn.GRU(hidden_size, hidden_size, batch_first=True)
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>        self.dropout = nn.Dropout(dropout_p)
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>    def forward(self, input):
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>        embedded = self.dropout(self.embedding(input))
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>        output, hidden = self.gru(embedded)
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>        return output, hidden
</code></pre></div>
<h3 id="_3">解码器 <a href="#the-decoder" title="此标题的永久链接">¶</a></h3>
<p>解码器是另一个 RNN，它采用编码器输出向量并
输出单词序列来创建翻译。</p>
<h4 id="_4">简单解码器 <a href="#simple-decoder" title="此标题的永久链接">¶</a></h4>
<p>在最简单的 seq2seq 解码器中，我们仅使用编码器的最后一个输出。
最后一个输出有时称为
 <em>上下文向量</em> 
，因为它对整个序列的上下文进行编码。该上下文向量用作
解码器的初始隐藏状态。</p>
<p>在解码的每一步，解码器都会获得一个输入令牌和
隐藏状态。初始输入标记是字符串开头
 <code>&lt;SOS&gt;</code>
 标记，第一个隐藏状态是上下文向量(编码器’s
最后一个隐藏状态)。</p>
<p><img alt="" src="https://pytorch.org/tutorials/_images/decoder-network.png" /></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>class DecoderRNN(nn.Module):
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    def __init__(self, hidden_size, output_size):
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>        super(DecoderRNN, self).__init__()
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>        self.embedding = nn.Embedding(output_size, hidden_size)
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>        self.gru = nn.GRU(hidden_size, hidden_size, batch_first=True)
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>        self.out = nn.Linear(hidden_size, output_size)
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    def forward(self, encoder_outputs, encoder_hidden, target_tensor=None):
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>        batch_size = encoder_outputs.size(0)
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>        decoder_input = torch.empty(batch_size, 1, dtype=torch.long, device=device).fill_(SOS_token)
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>        decoder_hidden = encoder_hidden
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>        decoder_outputs = []
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>        for i in range(MAX_LENGTH):
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>            decoder_output, decoder_hidden  = self.forward_step(decoder_input, decoder_hidden)
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>            decoder_outputs.append(decoder_output)
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>            if target_tensor is not None:
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>                # Teacher forcing: Feed the target as the next input
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>                decoder_input = target_tensor[:, i].unsqueeze(1) # Teacher forcing
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>            else:
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>                # Without teacher forcing: use its own predictions as the next input
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>                _, topi = decoder_output.topk(1)
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>                decoder_input = topi.squeeze(-1).detach()  # detach from history as input
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>        decoder_outputs = torch.cat(decoder_outputs, dim=1)
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>        decoder_outputs = F.log_softmax(decoder_outputs, dim=-1)
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>        return decoder_outputs, decoder_hidden, None # We return `None` for consistency in the training loop
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>    def forward_step(self, input, hidden):
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>        output = self.embedding(input)
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>        output = F.relu(output)
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>        output, hidden = self.gru(output, hidden)
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>        output = self.out(output)
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>        return output, hidden
</code></pre></div>
<p>我鼓励您训练并观察该模型的结果，但为了
节省空间，我们’ 将直接获得金牌并引入
注意力机制。</p>
<h4 id="_5">注意力解码器 <a href="#attention-decoder" title="永久链接到此标题">¶</a></h4>
<p>如果仅在编码器和解码器之间传递上下文向量，
该单个向量就承担了对整个句子进行编码的负担。</p>
<p>注意力机制允许解码器网络将解码器自己输出的每一步的“聚焦”在编码器’s输出的不同部分上。首先
我们计算一组
 <em>注意力权重</em> 
 。这些将乘以编码器输出向量以创建加权组合。结果(在代码中称为“attn_applied”)应包含有关输入序列特定部分的信息，从而帮助解码器选择正确的输出单词。</p>
<p><img alt="" src="https://i.imgur.com/1152PYf.png" /></p>
<p>计算注意力权重是通过另一个前馈
层
 <code>attn</code>
 完成的，使用解码器’s 输入和隐藏状态作为输入。
因为训练数据中有各种大小的句子，为了实际创建和训练该层，我们必须选择它可以应用的最大句子长度(输入长度​​，用于编码器输出)。最大长度的句子将使用所有注意力权重，
而较短的句子将仅使用前几个。</p>
<p><img alt="" src="https://pytorch.org/tutorials/_images/attention-decoder-network.png" /></p>
<p>Bahdanau 注意力，也称为附加注意力，是序列到序列模型中常用的注意力机制，特别是在神经机器翻译任务中。它是由 Bahdanau 等人提出的。在他们的
标题为
 <a href="https://arxiv.org/pdf/1409.0473.pdf">联合学习对齐和翻译的神经机器翻译</a> 的论文中
。
这种注意力机制采用学习的对齐模型来计算注意力\编码器和解码器隐藏状态之间的 nscore。它利用前馈
神经网络来计算对齐分数。</p>
<p>然而，还有其他可用的注意力机制，例如 Luong 注意力，它通过解码器隐藏状态和编码器隐藏状态之间的点积来计算注意力分数。它不涉及 Bahdanau 注意力中
使用的非线性变换。</p>
<p>在本教程中，我们将使用 Bahdanau 注意力。然而，探索修改注意力机制以使用 Luong 注意力将是一项有价值的练习。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>class BahdanauAttention(nn.Module):
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    def __init__(self, hidden_size):
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>        super(BahdanauAttention, self).__init__()
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        self.Wa = nn.Linear(hidden_size, hidden_size)
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>        self.Ua = nn.Linear(hidden_size, hidden_size)
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>        self.Va = nn.Linear(hidden_size, 1)
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    def forward(self, query, keys):
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>        scores = self.Va(torch.tanh(self.Wa(query) + self.Ua(keys)))
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>        scores = scores.squeeze(2).unsqueeze(1)
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>        weights = F.softmax(scores, dim=-1)
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>        context = torch.bmm(weights, keys)
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>        return context, weights
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>class AttnDecoderRNN(nn.Module):
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>    def __init__(self, hidden_size, output_size, dropout_p=0.1):
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>        super(AttnDecoderRNN, self).__init__()
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>        self.embedding = nn.Embedding(output_size, hidden_size)
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>        self.attention = BahdanauAttention(hidden_size)
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>        self.gru = nn.GRU(2 * hidden_size, hidden_size, batch_first=True)
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>        self.out = nn.Linear(hidden_size, output_size)
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>        self.dropout = nn.Dropout(dropout_p)
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>    def forward(self, encoder_outputs, encoder_hidden, target_tensor=None):
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>        batch_size = encoder_outputs.size(0)
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>        decoder_input = torch.empty(batch_size, 1, dtype=torch.long, device=device).fill_(SOS_token)
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>        decoder_hidden = encoder_hidden
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>        decoder_outputs = []
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>        attentions = []
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a>        for i in range(MAX_LENGTH):
<a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a>            decoder_output, decoder_hidden, attn_weights = self.forward_step(
<a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a>                decoder_input, decoder_hidden, encoder_outputs
<a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a>            )
<a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a>            decoder_outputs.append(decoder_output)
<a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a>            attentions.append(attn_weights)
<a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a>
<a id="__codelineno-11-40" name="__codelineno-11-40" href="#__codelineno-11-40"></a>            if target_tensor is not None:
<a id="__codelineno-11-41" name="__codelineno-11-41" href="#__codelineno-11-41"></a>                # Teacher forcing: Feed the target as the next input
<a id="__codelineno-11-42" name="__codelineno-11-42" href="#__codelineno-11-42"></a>                decoder_input = target_tensor[:, i].unsqueeze(1) # Teacher forcing
<a id="__codelineno-11-43" name="__codelineno-11-43" href="#__codelineno-11-43"></a>            else:
<a id="__codelineno-11-44" name="__codelineno-11-44" href="#__codelineno-11-44"></a>                # Without teacher forcing: use its own predictions as the next input
<a id="__codelineno-11-45" name="__codelineno-11-45" href="#__codelineno-11-45"></a>                _, topi = decoder_output.topk(1)
<a id="__codelineno-11-46" name="__codelineno-11-46" href="#__codelineno-11-46"></a>                decoder_input = topi.squeeze(-1).detach()  # detach from history as input
<a id="__codelineno-11-47" name="__codelineno-11-47" href="#__codelineno-11-47"></a>
<a id="__codelineno-11-48" name="__codelineno-11-48" href="#__codelineno-11-48"></a>        decoder_outputs = torch.cat(decoder_outputs, dim=1)
<a id="__codelineno-11-49" name="__codelineno-11-49" href="#__codelineno-11-49"></a>        decoder_outputs = F.log_softmax(decoder_outputs, dim=-1)
<a id="__codelineno-11-50" name="__codelineno-11-50" href="#__codelineno-11-50"></a>        attentions = torch.cat(attentions, dim=1)
<a id="__codelineno-11-51" name="__codelineno-11-51" href="#__codelineno-11-51"></a>
<a id="__codelineno-11-52" name="__codelineno-11-52" href="#__codelineno-11-52"></a>        return decoder_outputs, decoder_hidden, attentions
<a id="__codelineno-11-53" name="__codelineno-11-53" href="#__codelineno-11-53"></a>
<a id="__codelineno-11-54" name="__codelineno-11-54" href="#__codelineno-11-54"></a>
<a id="__codelineno-11-55" name="__codelineno-11-55" href="#__codelineno-11-55"></a>    def forward_step(self, input, hidden, encoder_outputs):
<a id="__codelineno-11-56" name="__codelineno-11-56" href="#__codelineno-11-56"></a>        embedded =  self.dropout(self.embedding(input))
<a id="__codelineno-11-57" name="__codelineno-11-57" href="#__codelineno-11-57"></a>
<a id="__codelineno-11-58" name="__codelineno-11-58" href="#__codelineno-11-58"></a>        query = hidden.permute(1, 0, 2)
<a id="__codelineno-11-59" name="__codelineno-11-59" href="#__codelineno-11-59"></a>        context, attn_weights = self.attention(query, encoder_outputs)
<a id="__codelineno-11-60" name="__codelineno-11-60" href="#__codelineno-11-60"></a>        input_gru = torch.cat((embedded, context), dim=2)
<a id="__codelineno-11-61" name="__codelineno-11-61" href="#__codelineno-11-61"></a>
<a id="__codelineno-11-62" name="__codelineno-11-62" href="#__codelineno-11-62"></a>        output, hidden = self.gru(input_gru, hidden)
<a id="__codelineno-11-63" name="__codelineno-11-63" href="#__codelineno-11-63"></a>        output = self.out(output)
<a id="__codelineno-11-64" name="__codelineno-11-64" href="#__codelineno-11-64"></a>
<a id="__codelineno-11-65" name="__codelineno-11-65" href="#__codelineno-11-65"></a>        return output, hidden, attn_weights
</code></pre></div>
<p>没有10</p>
<p>还有其他形式的注意力通过使用相对位置方法来解决长度限制。阅读
 <a href="https://arxiv.org/abs/1508.04025">基于注意力的神经机器的有效方法
翻译</a> 
 中有关 “local
attention” 的内容。
.</p>
<h2 id="_6">训练 <a href="#training" title="固定链接到此标题">¶</a></h2>
<h3 id="_7">准备训练数据 <a href="#preparing-training-data" title="永久链接到此标题">¶</a></h3>
<p>为了训练，对于每一对，我们需要一个输入tensor(输入句子中单词的索引)和目标tensor(目标句子中单词的索引)。创建这些向量时，我们会将
EOS 令牌附加到两个序列中。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>def indexesFromSentence(lang, sentence):
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    return [lang.word2index[word] for word in sentence.split(&#39; &#39;)]
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>def tensorFromSentence(lang, sentence):
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    indexes = indexesFromSentence(lang, sentence)
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    indexes.append(EOS_token)
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    return torch.tensor(indexes, dtype=torch.long, device=device).view(1, -1)
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>def tensorsFromPair(pair):
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>    input_tensor = tensorFromSentence(input_lang, pair[0])
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>    target_tensor = tensorFromSentence(output_lang, pair[1])
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>    return (input_tensor, target_tensor)
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>def get_dataloader(batch_size):
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>    input_lang, output_lang, pairs = prepareData(&#39;eng&#39;, &#39;fra&#39;, True)
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>    n = len(pairs)
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>    input_ids = np.zeros((n, MAX_LENGTH), dtype=np.int32)
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>    target_ids = np.zeros((n, MAX_LENGTH), dtype=np.int32)
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>    for idx, (inp, tgt) in enumerate(pairs):
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>        inp_ids = indexesFromSentence(input_lang, inp)
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>        tgt_ids = indexesFromSentence(output_lang, tgt)
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>        inp_ids.append(EOS_token)
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a>        tgt_ids.append(EOS_token)
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>        input_ids[idx, :len(inp_ids)] = inp_ids
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>        target_ids[idx, :len(tgt_ids)] = tgt_ids
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>    train_data = TensorDataset(torch.LongTensor(input_ids).to(device),
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>                               torch.LongTensor(target_ids).to(device))
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>    train_sampler = RandomSampler(train_data)
<a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a>    train_dataloader = DataLoader(train_data, sampler=train_sampler, batch_size=batch_size)
<a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a>    return input_lang, output_lang, train_dataloader
</code></pre></div>
<h3 id="_8">训练模型 <a href="#training-the-model" title="永久链接到此标题">¶</a></h3>
<p>为了训练，我们通过编码器运行输入句子，并跟踪每个输出和最新的隐藏状态。然后，解码器被赋予
<code>&lt;SOS&gt;</code>
 标记作为其第一个输入，
编码器的最后一个隐藏状态作为其第一个隐藏状态。</p>
<p>“教师强制” 的概念是使用真实目标输出作为
每个下一个输入，而不是使用解码器’s 猜测作为下一个输入。
使用教师强制会使其收敛得更快，但是
<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.378.4095&amp;rep=rep1&amp;type =pdf">当训练好的网络被利用时，它可能会表现出稳定性</a> 
.</p>
<p>您可以观察教师强制网络的输出，
这些网络使用连贯的语法进行读取，但偏离正确的翻译 - 
直观地它已经学会了表示输出语法，并且可以 \xe2\x80\x9cpick
up\xe2\x80\一旦老师告诉它前几个单词，它就知道了含义，但
它一开始就没有正确学习如何从翻译中创建句子。</p>
<p>由于 PyTorch’s autograd 给我们带来了自由，我们可以通过简单的 if 语句随机
选择是否使用教师强制。调高
 <code>teacher_forcing_ratio</code>
 以使用更多。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>def train_epoch(dataloader, encoder, decoder, encoder_optimizer,
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>          decoder_optimizer, criterion):
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    total_loss = 0
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    for data in dataloader:
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>        input_tensor, target_tensor = data
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>        encoder_optimizer.zero_grad()
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>        decoder_optimizer.zero_grad()
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>        encoder_outputs, encoder_hidden = encoder(input_tensor)
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>        decoder_outputs, _, _ = decoder(encoder_outputs, encoder_hidden, target_tensor)
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>        loss = criterion(
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>            decoder_outputs.view(-1, decoder_outputs.size(-1)),
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>            target_tensor.view(-1)
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>        )
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>        loss.backward()
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>        encoder_optimizer.step()
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>        decoder_optimizer.step()
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>        total_loss += loss.item()
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>    return total_loss / len(dataloader)
</code></pre></div>
<p>这是一个辅助函数，用于在给定当前时间和进度 % 的情况下打印已用时间和
估计剩余时间。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>import time
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>import math
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>def asMinutes(s):
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    m = math.floor(s / 60)
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    s -= m * 60
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>    return &#39;%dm %ds&#39; % (m, s)
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>def timeSince(since, percent):
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>    now = time.time()
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>    s = now - since
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>    es = s / (percent)
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>    rs = es - s
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>    return &#39;%s (- %s)&#39; % (asMinutes(s), asMinutes(rs))
</code></pre></div>
<p>整个训练过程是这样的：</p>
<ul>
<li>启动计时器</li>
<li>初始化优化器和标准</li>
<li>创建训练对集</li>
<li>启动空损失数组用于绘图</li>
</ul>
<p>然后我们多次调用
 <code>train</code>
 并偶尔打印进度(示例的%
、到目前为止的时间、估计时间)和平均损失。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>def train(train_dataloader, encoder, decoder, n_epochs, learning_rate=0.001,
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>               print_every=100, plot_every=100):
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    start = time.time()
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    plot_losses = []
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    print_loss_total = 0  # Reset every print_every
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    plot_loss_total = 0  # Reset every plot_every
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>    encoder_optimizer = optim.Adam(encoder.parameters(), lr=learning_rate)
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>    decoder_optimizer = optim.Adam(decoder.parameters(), lr=learning_rate)
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>    criterion = nn.NLLLoss()
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>    for epoch in range(1, n_epochs + 1):
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>        loss = train_epoch(train_dataloader, encoder, decoder, encoder_optimizer, decoder_optimizer, criterion)
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>        print_loss_total += loss
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>        plot_loss_total += loss
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>        if epoch % print_every == 0:
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a>            print_loss_avg = print_loss_total / print_every
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>            print_loss_total = 0
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>            print(&#39;%s (%d %d%%) %.4f&#39; % (timeSince(start, epoch / n_epochs),
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>                                        epoch, epoch / n_epochs * 100, print_loss_avg))
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>        if epoch % plot_every == 0:
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>            plot_loss_avg = plot_loss_total / plot_every
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a>            plot_losses.append(plot_loss_avg)
<a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>            plot_loss_total = 0
<a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>
<a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>    showPlot(plot_losses)
</code></pre></div>
<h3 id="_9">绘制结果 <a href="#plotting-results" title="此标题的固定链接">¶</a></h3>
<p>绘图是使用 matplotlib 完成的，使用损失值数组
 <code>plot_losses</code>
 在训练时保存。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>import matplotlib.pyplot as plt
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>plt.switch_backend(&#39;agg&#39;)
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>import matplotlib.ticker as ticker
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>import numpy as np
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>def showPlot(points):
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>    plt.figure()
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>    fig, ax = plt.subplots()
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>    # this locator puts ticks at regular intervals
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>    loc = ticker.MultipleLocator(base=0.2)
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>    ax.yaxis.set_major_locator(loc)
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>    plt.plot(points)
</code></pre></div>
<h2 id="_10">评估 <a href="#evaluation" title="此标题的永久链接">¶</a></h2>
<p>评估与训练基本相同，但没有目标，因此
我们只需在每个步骤中将解码器’s 的预测反馈给自身。
每次它预测一个单词时，我们都会将其添加到输出字符串中，如果它预测了 EOS 代币，我们就到此为止。我们还存储解码器’s
attention 输出以供稍后显示。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>def evaluate(encoder, decoder, sentence, input_lang, output_lang):
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    with torch.no_grad():
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>        input_tensor = tensorFromSentence(input_lang, sentence)
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>        encoder_outputs, encoder_hidden = encoder(input_tensor)
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        decoder_outputs, decoder_hidden, decoder_attn = decoder(encoder_outputs, encoder_hidden)
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>        _, topi = decoder_outputs.topk(1)
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>        decoded_ids = topi.squeeze()
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>        decoded_words = []
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>        for idx in decoded_ids:
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>            if idx.item() == EOS_token:
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>                decoded_words.append(&#39;&lt;EOS&gt;&#39;)
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>                break
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>            decoded_words.append(output_lang.index2word[idx.item()])
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>    return decoded_words, decoder_attn
</code></pre></div>
<p>我们可以评估训练集中的随机句子并打印
输入、目标和输出，以做出一些主观质量判断：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>def evaluateRandomly(encoder, decoder, n=10):
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>    for i in range(n):
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>        pair = random.choice(pairs)
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>        print(&#39;&gt;&#39;, pair[0])
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>        print(&#39;=&#39;, pair[1])
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>        output_words, _ = evaluate(encoder, decoder, pair[0], input_lang, output_lang)
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>        output_sentence = &#39; &#39;.join(output_words)
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>        print(&#39;&lt;&#39;, output_sentence)
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>        print(&#39;&#39;)
</code></pre></div>
<h2 id="_11">训练和评估 <a href="#training-and-evaluating" title="永久链接到此标题">¶</a></h2>
<p>有了所有这些辅助函数(看起来像是额外的工作，但
可以更轻松地运行多个实验)，我们实际上可以
初始化网络并开始训练。</p>
<p>请记住，输入的句子经过严格过滤。对于这个小数据集，我们可以使用由 256 个隐藏节点和一个 GRU 层组成的相对较小的网络。在 MacBook CPU 上运行大约 40 分钟后，我们’ 将得到一些
合理的结果。</p>
<p>注意</p>
<p>如果您运行此笔记本，您可以训练、中断内核、
评估并稍后继续训练。注释掉编码器和解码器初始化的行，并再次运行
 <code>trainIters</code>。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>hidden_size = 128
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>batch_size = 32
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>input_lang, output_lang, train_dataloader = get_dataloader(batch_size)
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>encoder = EncoderRNN(input_lang.n_words, hidden_size).to(device)
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>decoder = AttnDecoderRNN(hidden_size, output_lang.n_words).to(device)
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>train(train_dataloader, encoder, decoder, 80, print_every=5, plot_every=5)
</code></pre></div>
<ul>
<li><img alt="seq2seq 翻译教程" src="https://pytorch.org/tutorials/_images/sphx_glr_seq2seq_translation_tutorial_001.png" /></li>
<li><img alt="seq2seq 翻译教程" src="https://pytorch.org/tutorials/_images/sphx_glr_seq2seq_translation_tutorial_002.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>Reading lines...
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>Read 135842 sentence pairs
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>Trimmed to 11445 sentence pairs
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>Counting words...
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>Counted words:
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>fra 4601
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>eng 2991
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>0m 27s (- 6m 51s) (5 6%) 1.5304
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>0m 54s (- 6m 19s) (10 12%) 0.6776
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>1m 21s (- 5m 51s) (15 18%) 0.3528
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>1m 47s (- 5m 23s) (20 25%) 0.1946
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>2m 14s (- 4m 56s) (25 31%) 0.1205
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>2m 41s (- 4m 29s) (30 37%) 0.0841
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>3m 8s (- 4m 2s) (35 43%) 0.0639
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>3m 35s (- 3m 35s) (40 50%) 0.0521
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>4m 2s (- 3m 8s) (45 56%) 0.0452
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>4m 29s (- 2m 41s) (50 62%) 0.0395
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>4m 55s (- 2m 14s) (55 68%) 0.0377
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>5m 22s (- 1m 47s) (60 75%) 0.0349
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>5m 49s (- 1m 20s) (65 81%) 0.0324
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>6m 16s (- 0m 53s) (70 87%) 0.0316
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>6m 43s (- 0m 26s) (75 93%) 0.0298
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>7m 10s (- 0m 0s) (80 100%) 0.0291
</code></pre></div>
<p>将 dropout 层设置为
 <code>eval</code>
 模式</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>encoder.eval()
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>decoder.eval()
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>evaluateRandomly(encoder, decoder)
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>&gt; il est si mignon !
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>= he s so cute
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>&lt; he s so cute &lt;EOS&gt;
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>&gt; je vais me baigner
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>= i m going to take a bath
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>&lt; i m going to take a bath &lt;EOS&gt;
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>&gt; c est un travailleur du batiment
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>= he s a construction worker
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>&lt; he s a construction worker &lt;EOS&gt;
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>&gt; je suis representant de commerce pour notre societe
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>= i m a salesman for our company
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>&lt; i m a salesman for our company &lt;EOS&gt;
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>&gt; vous etes grande
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>= you re big
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>&lt; you are big &lt;EOS&gt;
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>&gt; tu n es pas normale
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>= you re not normal
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a>&lt; you re not normal &lt;EOS&gt;
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a>&gt; je n en ai pas encore fini avec vous
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a>= i m not done with you yet
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a>&lt; i m not done with you yet &lt;EOS&gt;
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a>&gt; je suis desole pour ce malentendu
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a>= i m sorry about my mistake
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a>&lt; i m sorry about my mistake &lt;EOS&gt;
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a>
<a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a>&gt; nous ne sommes pas impressionnes
<a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a>= we re not impressed
<a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a>&lt; we re not impressed &lt;EOS&gt;
<a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a>
<a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a>&gt; tu as la confiance de tous
<a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a>= you are trusted by every one of us
<a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a>&lt; you are trusted by every one of us &lt;EOS&gt;
</code></pre></div>
<h3 id="_12">可视化注意力 <a href="#visualizing-attention" title="永久链接到此标题">¶</a></h3>
<p>注意力机制的一个有用属性是其高度可解释的
输出。因为它用于对输入序列的
特定编码器输出进行加权，所以我们可以想象在每个时间步
查看网络最关注的位置。</p>
<p>您可以简单地运行
 <code>plt.matshow(attentions)</code>
 来查看显示为矩阵的注意力输出。为了获得更好的观看体验，我们将执行
添加轴和标签的额外工作：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>def showAttention(input_sentence, output_words, attentions):
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>    fig = plt.figure()
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>    ax = fig.add_subplot(111)
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>    cax = ax.matshow(attentions.cpu().numpy(), cmap=&#39;bone&#39;)
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>    fig.colorbar(cax)
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>    # Set up axes
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>    ax.set_xticklabels([&#39;&#39;] + input_sentence.split(&#39; &#39;) +
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>                       [&#39;&lt;EOS&gt;&#39;], rotation=90)
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>    ax.set_yticklabels([&#39;&#39;] + output_words)
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>    # Show label at every tick
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>    ax.xaxis.set_major_locator(ticker.MultipleLocator(1))
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>    ax.yaxis.set_major_locator(ticker.MultipleLocator(1))
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>    plt.show()
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>defvaluateAndShowAttention(input_sentence):
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a> 输出_words, 注意 = 评估(编码器, 解码器, 输入_sentence, 输入_lang, 输出_lang)
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a> print(&#39;input =&#39;, input\ \_sentence)
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a> print(&#39;output =&#39;, &#39; &#39;.join(output_words))
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a> showAttention(input_sentence, 输出_words, 注意[0, :len(output_words), :])
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>evaluateAndShowAttention(&#39;il n est pas aussi grand que son pere&#39;)
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>evaluateAndShowAttention(&#39;je suis trop fatigue pour conduire&#39;)
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>evaluateAndShowAttention(&#39;je suis desole si c est une question idiote&#39;)
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>evaluateAndShowAttention(&#39;je suis reellement fiere de vous&#39;)
</code></pre></div>
<ul>
<li><img alt="seq2seq 翻译教程" src="https://pytorch.org/tutorials/_images/sphx_glr_seq2seq_translation_tutorial_003.png" /></li>
<li><img alt="seq2seq 翻译教程" src="https://pytorch.org/tutorials/_images/sphx_glr_seq2seq_translation_tutorial_004.png" /></li>
<li><img alt="seq2seq 翻译教程" src=".. /_images/sphx_glr_seq2seq_translation_tutorial_005.png" /></li>
<li><img alt="seq2seq 翻译教程" src="https://pytorch.org/tutorials/_images/sphx_glr_seq2seq_translation_tutorial_006.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>input = il n est pas aussi grand que son pere
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>output = he is not as tall as his father &lt;EOS&gt;
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>/var/lib/jenkins/workspace/intermediate_source/seq2seq_translation_tutorial.py:823: UserWarning:
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>/var/lib/jenkins/workspace/intermediate_source/seq2seq_translation_tutorial.py:825: UserWarning:
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>input = je suis trop fatigue pour conduire
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>output = i m too tired to drive &lt;EOS&gt;
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>/var/lib/jenkins/workspace/intermediate_source/seq2seq_translation_tutorial.py:823: UserWarning:
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>/var/lib/jenkins/workspace/intermediate_source/seq2seq_translation_tutorial.py:825: UserWarning:
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>input = je suis desole si c est une question idiote
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>output = i m sorry if this is a stupid question &lt;EOS&gt;
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>/var/lib/jenkins/workspace/intermediate_source/seq2seq_translation_tutorial.py:823: UserWarning:
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>/var/lib/jenkins/workspace/intermediate_source/seq2seq_translation_tutorial.py:825: UserWarning:
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a>
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a>input = je suis reellement fiere de vous
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>output = i m really proud of you guys &lt;EOS&gt;
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a>/var/lib/jenkins/workspace/intermediate_source/seq2seq_translation_tutorial.py:823: UserWarning:
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a>
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
<a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a>
<a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a>/var/lib/jenkins/workspace/intermediate_source/seq2seq_translation_tutorial.py:825: UserWarning:
<a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a>
<a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a>set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
</code></pre></div>
<h2 id="_13">练习 <a href="#exercises" title="永久链接到此标题">¶</a></h2>
<ul>
<li>
<p>尝试使用不同的数据集</p>
<ul>
<li>另一种语言对</li>
<li>人类 → 机器(例如 IOT 命令)</li>
<li>聊天 → 响应</li>
<li>问题 → 答案</li>
<li>替换具有预训练词嵌入的嵌入，例如
 <code>word2vec</code>
 或
 <code>GloVe</code></li>
<li>尝试使用更多层、更多隐藏单元和更多句子。比较
训练时间和结果。</li>
<li>如果您使用的翻译文件中具有两个相同的短语
(
 `I</li>
</ul>
</li>
</ul>
<p>am</p>
<p>test</p>
<p>\t</p>
<p>I</p>
<p>am</p>
<p>test`
 )，您可以将其用作自动编码器。尝试
这个：</p>
<div class="highlight"><pre><span></span><code>+ 训练为自动编码器
+ 仅保存编码器网络
+ 训练新的解码器以从那里进行翻译
</code></pre></div>
<p><strong>脚本的总运行时间：</strong> 
(7 分 19.245 秒)</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../char_rnn_generation_tutorial/" class="md-footer__link md-footer__link--prev" aria-label="Previous: NLP From Scratch: Generating Names with a Character-Level RNN">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                NLP From Scratch: Generating Names with a Character-Level RNN
              </div>
            </div>
          </a>
        
        
          
          <a href="../../beginner/text_sentiment_ngrams_tutorial/" class="md-footer__link md-footer__link--next" aria-label="Next: Text classification with the torchtext library">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Text classification with the torchtext library
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "content.action.edit", "content.action.view", "navigation.footer"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>